--- code/smutil
+++ SHRDLU/SMUTIL
@@ -28,7 +28,7 @@
 			   (T (ERT ISTENSE -- FUNNY ARG)))))) 
 
 (DEFUN IMPERF? (TSS) 
-       (AND (CDR (SETQ X (TENSE? X))) (EQ (CAR X) 'PRESENT))) 
+       (AND (CDR (SETQ TSS (TENSE? TSS))) (EQ (CAR TSS) 'PRESENT))) 
 
 (DEFUN IMPERF NIL (ISTENSE C 'IMPERF)) 
 
@@ -42,7 +42,7 @@
        ;;;     MARKERS=         <LIST OF SEMANTIC MARKERS> 
        ;;;     SYSTEMS=         <LIST OF SYSTEMS FOR THOSE MARKERS--USED FOR FAST
        ;;;                          MARKER CHECKING?>
-       ;;;     PLAUSIBILITY=    <INTEGER BETWEEN 0 AND 1000 USED IN DISAMBIGNUATION> 
+       ;;;     PLAUSIBILITY=    <INTEGER BETWEEN 0 AND 01000 USED IN DISAMBIGNUATION> 
        ;;;     RSSNODE=         <NODE NAME FOR AN RSS>
        ;;;     OSSNODE=         <NODE NAME FOR AN OSS> 
        ;;;     PARSENODE=      <CORRESPONDING NODE OF PARSE TREE>
@@ -113,13 +113,13 @@
 (DEFUN NEWCOPY (OSS) 
        (PROG (OLD NEW) 
 	     (SETQ NEW (MAKESYM 'OSS))
-	     (SETQ OLD (CDR OSS))
+	     (SETQ OLD (PLIST OSS))
 								       ;WATCH OUT -- THIS IS IMPLEMENTATION DEPENDENT,
 	UP   (COND ((NULL OLD)
 								       ;AND GETS THE ENTIRE PROPERTY LIST IN OUR LISP.
 		    (PUTPROP NEW C 'PARSENODE=)
 		    (RETURN NEW))
-		   ((EQ (CAR OLD) 'PNAME))
+		   ((MEMQ (CAR OLD) '(PNAME EXPR FEXPR LEXPR MACRO SUBR FSUBR LSUBR)))
 		   ((PUTPROP NEW (CADR OLD) (CAR OLD))))
 	     (SETQ OLD (CDDR OLD))
 	     (GO UP))) 
@@ -148,7 +148,7 @@
        ;;;                                   SMOB2 FOR CADDR
        ;;;     PROCEDURE:        CONDENSED PLANNER CODE SCHEMA
        ;;;     MARKERS:          SEMANTIC MARKERS
-       ;;;     PLAUSIBILITY:     EVALUATED TO GET INTEGER FROM 0 TO 1000 INDICATING RELATIVE
+       ;;;     PLAUSIBILITY:     EVALUATED TO GET INTEGER FROM 0 TO 01000 INDICATING RELATIVE
        ;;;                          LIKLIHOOD OF THIS DEFINITION SENSE.
        ;;;     REL:                ******>>>
        ;;;
@@ -393,7 +393,7 @@
        ;;IN THE INPUT S-EXPRESSION L.  IF IT FINDS ONE THEN THE
        ;;EXPRESSION MUMBLE IS EVALUATED AND REPACES (#EVAL ...),
        ;;OTHERWISE L IS RETURNED JUST 
-THE WAY IT WAS.  HENCE THIS
+       ;;THE WAY IT WAS.  HENCE THIS
        ;;FUNCTION IS THE INVERSE OF QUOTE. 
        (COND ((ATOM L) L)
 	     ((EQ (CAR L) '#EVAL) (EVAL (CADR L)))
@@ -476,7 +476,7 @@
        ;;SIDE-EFFECTS).
        (PROG (ANS F) 
 	     (AND (NULL L) (SETQ L '(NIL)))
-	A    (COND ((NULL (SETQ F ((EVAL 'FN) (CAR L)))))
+	A    (COND ((NULL (SETQ F (FUNCALL FN (CAR L)))))
 		   ((ATOM F) (SETQ ANS (NCONC ANS (CONS F NIL))))
 		   ((SETQ ANS (APPEND ANS F))))
 	     (SETQ L (CDR L))
@@ -498,7 +498,7 @@
        (PROG (DUMMY) ;DUMMY IS USED TO ESCAPE FROM A SYSTEM ERROR
 	A    (COND ((NULL L) (RETURN T)))
 								       ;WHICH OCCURS WHEN NIL IS USED			
-	     ((EVAL 'FN) (CAR L) (CADR L))
+	     (FUNCALL FN (CAR L) (CADR L))
 								       ;	   FN APPLIED TO TOP TWO ELEMENTS. EVAL
 	     (SETQ L (CDDR L))
 								       ;IS TO AVOID CONFLICT WITH FUNCTION REALLY NAMED
@@ -532,7 +532,7 @@
        ;; INPUTS ARE IN KEYWORD FORMAT (ATTRIBUTE-VALUE PAIRS).  THE
        ;;KEYWORD IS NOT EVALUATED BUT ITS VLUE IS.  POSIBLE KEYWORDS:
        ;;;     MARKERS:            LIST OF SEMANTIC MARKERS
-       ;;;     PLAUSIBILITY:       EVALS TO INTEGER FROM 0 TO 1000 INDICATING RELATIVE
+       ;;;     PLAUSIBILITY:       EVALS TO INTEGER FROM 0 TO 01000 INDICATING RELATIVE
        ;;;                         LIKLIHOOD OF THIS DEFINITION SENSE
        ;;;     DET:                ****I'M TOO LAZY TOO LOKK THIS UP NOW
 								       ; FILL IN DET********************
@@ -860,7 +860,7 @@
 								       ;THIS INSTANCE OF IT HAS.  (LENGTH ...) COMPUTES
 		       ;THE NUMBER OF ARGUMENTS + 1 AND THE (ASSQ ...)
 		       ;RETRIEVES THE 
-APPROPRIATE RECOMMENDATION USING
+		       ;APPROPRIATE RECOMMENDATION USING
 		       ;THIS NUMBER.  IF THERE IS NO SUCH  NUMBER,
 		       ;NUMBERP FAILS AND SOME ARBITARY FUNCTION WHICH
 		       ;IS STORED OUT THERE IS EVALUATED TO GIVE THE
