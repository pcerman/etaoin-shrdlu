--- code/smutil	1997-09-16 19:16:36.000000000 +0200
+++ SHRDLU/SMUTIL	2020-12-06 21:46:17.000000000 +0100
@@ -28,7 +28,7 @@
 			   (T (ERT ISTENSE -- FUNNY ARG)))))) 
 
 (DEFUN IMPERF? (TSS) 
-       (AND (CDR (SETQ X (TENSE? X))) (EQ (CAR X) 'PRESENT))) 
+       (AND (CDR (SETQ TSS (TENSE? TSS))) (EQ (CAR TSS) 'PRESENT))) 
 
 (DEFUN IMPERF NIL (ISTENSE C 'IMPERF)) 
 
@@ -113,13 +113,13 @@
 (DEFUN NEWCOPY (OSS) 
        (PROG (OLD NEW) 
 	     (SETQ NEW (MAKESYM 'OSS))
-	     (SETQ OLD (CDR OSS))
+	     (SETQ OLD (PLIST OSS))
 								       ;WATCH OUT -- THIS IS IMPLEMENTATION DEPENDENT,
 	UP   (COND ((NULL OLD)
 								       ;AND GETS THE ENTIRE PROPERTY LIST IN OUR LISP.
 		    (PUTPROP NEW C 'PARSENODE=)
 		    (RETURN NEW))
-		   ((EQ (CAR OLD) 'PNAME))
+		   ((MEMQ (CAR OLD) '(PNAME EXPR FEXPR LEXPR MACRO SUBR FSUBR LSUBR)))
 		   ((PUTPROP NEW (CADR OLD) (CAR OLD))))
 	     (SETQ OLD (CDDR OLD))
 	     (GO UP))) 
@@ -393,7 +393,7 @@
        ;;IN THE INPUT S-EXPRESSION L.  IF IT FINDS ONE THEN THE
        ;;EXPRESSION MUMBLE IS EVALUATED AND REPACES (#EVAL ...),
        ;;OTHERWISE L IS RETURNED JUST 
-THE WAY IT WAS.  HENCE THIS
+       ;;THE WAY IT WAS.  HENCE THIS
        ;;FUNCTION IS THE INVERSE OF QUOTE. 
        (COND ((ATOM L) L)
 	     ((EQ (CAR L) '#EVAL) (EVAL (CADR L)))
@@ -476,7 +476,7 @@
        ;;SIDE-EFFECTS).
        (PROG (ANS F) 
 	     (AND (NULL L) (SETQ L '(NIL)))
-	A    (COND ((NULL (SETQ F ((EVAL 'FN) (CAR L)))))
+	A    (COND ((NULL (SETQ F (FUNCALL FN (CAR L)))))
 		   ((ATOM F) (SETQ ANS (NCONC ANS (CONS F NIL))))
 		   ((SETQ ANS (APPEND ANS F))))
 	     (SETQ L (CDR L))
@@ -498,7 +498,7 @@
        (PROG (DUMMY) ;DUMMY IS USED TO ESCAPE FROM A SYSTEM ERROR
 	A    (COND ((NULL L) (RETURN T)))
 								       ;WHICH OCCURS WHEN NIL IS USED			
-	     ((EVAL 'FN) (CAR L) (CADR L))
+	     (FUNCALL FN (CAR L) (CADR L))
 								       ;	   FN APPLIED TO TOP TWO ELEMENTS. EVAL
 	     (SETQ L (CDDR L))
 								       ;IS TO AVOID CONFLICT WITH FUNCTION REALLY NAMED
@@ -860,7 +860,7 @@
 								       ;THIS INSTANCE OF IT HAS.  (LENGTH ...) COMPUTES
 		       ;THE NUMBER OF ARGUMENTS + 1 AND THE (ASSQ ...)
 		       ;RETRIEVES THE 
-APPROPRIATE RECOMMENDATION USING
+		       ;APPROPRIATE RECOMMENDATION USING
 		       ;THIS NUMBER.  IF THERE IS NO SUCH  NUMBER,
 		       ;NUMBERP FAILS AND SOME ARBITARY FUNCTION WHICH
 		       ;IS STORED OUT THERE IS EVALUATED TO GIVE THE
